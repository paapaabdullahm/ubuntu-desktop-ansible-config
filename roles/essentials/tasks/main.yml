---

- name: Ensure the system can use the HTTPS transport for APT
  stat: path=/usr/lib/apt/methods/https
  register: apt_https_transport

- name: Install HTTPS transport for APT
  apt: pkg=apt-transport-https state=installed
  when: not apt_https_transport.stat.exists

- name: Enable all repositories in sources.list
  replace: dest=/etc/apt/sources.list regexp='^#\s?deb(.+)http://(.+)/ubuntu(.+)$' replace='deb\1http://\2/ubuntu\3' backup=yes

- name: Ensure that Aptitude repositories are up to date
  apt: update_cache=yes cache_valid_time={{ aptcachetime }}

- name: Install essential packages
  apt: pkg={{ item }} state=latest update_cache=yes cache_valid_time={{ aptcachetime }}
  with_items:
    - afuse
    - aptitude
    - axel
    - build-essential
    - bzip2
    - colortest
    - curl
    - dbus
    - diffutils
    - dos2unix
    - fdupes
    - findutils
    - ftp-ssl
    - gawk
    - gcc
    - gimp
    - grep
    - gufw
    - gzip
    - htop
    - httping
    - iftop
    - imagemagick
    - iotop
    - kdenlive
    - less
    - lftp
    - libappindicator1
    - make
    - meld
    - nano
    - nfs-common
    - nmap
    - openconnect
    - openssl
    - p7zip
    - pv
    - pwgen
    - python
    - python-dbus
    - python-dev
    - python-pip
    - ranger
    - rar
    - rsync
    - sed
    - shutter
    - smbclient
    - software-properties-common
    - sshfs
    - sshpass
    - swapspace
    - tar
    - tesseract-ocr
    - tig
    - tmux
    - trash-cli
    - ttf-mscorefonts-installer
    - ufw
    - unzip
    - vim
    - vlc
    - vpnc
    - wget
    - whois
    - xmlstarlet
    - xournal
    - youtube-dl
    - zip

- name: Upgrade installed packages
  apt: upgrade=yes
